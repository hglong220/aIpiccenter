diff --git a/lib/multimodal-parser.ts b/lib/multimodal-parser.ts
index 1234567..abcdefg 100644
--- a/lib/multimodal-parser.ts
+++ b/lib/multimodal-parser.ts
@@ -229,20 +229,20 @@ async function parseExcel(file: any): Promise<ParseResult> {
 async function parseExcel(file: any): Promise<ParseResult> {
   try {
-    // 需要安装 xlsx: npm install xlsx
-    const XLSX = await import('xlsx').catch(() => null)
+    // 使用 exceljs 替代 xlsx (修复安全漏洞)
+    const ExcelJS = await import('exceljs').catch(() => null)
     
-    if (!XLSX) {
-      throw new Error('xlsx未安装，请运行: npm install xlsx')
+    if (!ExcelJS) {
+      throw new Error('exceljs未安装，请运行: npm install exceljs')
     }
 
     const fs = await import('fs/promises')
     const path = await import('path')
     const filePath = path.join(process.cwd(), 'storage', file.storagePath)
     const fileBuffer = await fs.readFile(filePath)
 
-    const workbook = XLSX.read(fileBuffer, { type: 'buffer' })
+    const workbook = new ExcelJS.Workbook()
+    await workbook.xlsx.load(fileBuffer)
     
     // 转换为JSON
     const sheets: Record<string, any[]> = {}
-    workbook.SheetNames.forEach(sheetName => {
-      const sheet = workbook.Sheets[sheetName]
-      sheets[sheetName] = XLSX.utils.sheet_to_json(sheet)
+    workbook.eachSheet((worksheet, sheetId) => {
+      const sheetData: any[] = []
+      worksheet.eachRow((row, rowNumber) => {
+        const rowData: any = {}
+        row.eachCell((cell, colNumber) => {
+          rowData[colNumber] = cell.value
+        })
+        sheetData.push(rowData)
+      })
+      sheets[worksheet.name] = sheetData
     })
     
     return {
       type: 'document',
       extractedData: sheets,
       metadata: {
         document: {
-          pageCount: workbook.SheetNames.length,
+          pageCount: workbook.worksheets.length,
         },
       },
     }
   } catch (error) {
     throw new Error(`Excel解析失败: ${error instanceof Error ? error.message : 'Unknown error'}`)
   }
 }

diff --git a/package.json b/package.json
index 1234567..abcdefg 100644
--- a/package.json
+++ b/package.json
@@ -50,7 +50,7 @@
     "sharp": "^0.33.0",
     "lru-cache": "^10.2.0",
     "pdf-parse": "^1.1.1",
     "mammoth": "^1.6.0",
-    "xlsx": "^0.18.5"
+    "exceljs": "^4.4.0"
   },
   "devDependencies": {
     "@types/bcryptjs": "^2.4.6",

