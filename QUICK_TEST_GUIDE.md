# ⚡ 快速测试指南

## 🚀 立即测试命令

### 1. 测试不使用代理（最重要）
```bash
node scripts/test-no-proxy.js
```
**目的**: 测试直接连接的速度。如果速度显著提升（降至3-5秒），说明代理是主要瓶颈。

### 2. 测试代理延迟
```bash
node scripts/test-proxy-latency.js
```
**目的**: 如果延迟 > 500ms，代理可能是瓶颈。

### 3. 综合性能测试
```bash
node scripts/test-performance-comprehensive.js
```
**目的**: 对比不使用代理 vs 使用代理的性能。

## 📊 查看服务器日志中的 TTFB

发送消息后，查看服务器日志：
```bash
# 在服务器日志中查找 TTFB
grep "TTFB" logs/*.log
# 或查看控制台输出
```

**判断标准**:
- **TTFB < 500ms**: 网络正常，问题在解析
- **TTFB > 1000ms**: 网络延迟是主要问题
- **TTFB > 2000ms**: 网络延迟非常严重

## 🔍 当前测试结果

### 代理延迟测试
- **代理**: `http://47.79.137.153:3128`
- **延迟**: **1820ms** ❌ (非常高！)
- **结论**: **代理延迟是主要瓶颈**

### 不使用代理测试
- **结果**: ❌ 直接连接失败
- **原因**: 网络防火墙阻止直接访问
- **结论**: **必须使用代理**

## 💡 关键发现

1. **代理延迟是主要瓶颈** (1820ms)
2. **必须使用代理** (直接连接失败)
3. **需要更换更快的代理服务器**

## 🎯 下一步行动

### 优先级 1: 更换代理服务器
- 选择延迟 < 50ms 的代理
- 使用香港/新加坡的代理
- 考虑付费代理服务

### 优先级 2: 查看服务器日志
- 发送一条消息
- 查看日志中的 TTFB 时间
- 确认网络延迟是否为主要问题

### 优先级 3: 测试新代理
```bash
# 临时设置新代理
export GEMINI_PROXY_URL=http://新代理地址:端口

# 测试性能
node scripts/test-proxy-latency.js
```

## 📈 性能目标

- **TTFB**: < 500ms
- **首字显示时间**: < 1000ms
- **完整响应时间**: < 3000ms

## 🔧 测试脚本说明

### `test-no-proxy.js`
测试不使用代理的直接连接性能。

### `test-proxy-latency.js`
测试代理服务器的延迟。

### `test-performance-comprehensive.js`
综合测试，对比不使用代理 vs 使用代理的性能。

---

**快速参考**: 运行 `node scripts/test-proxy-latency.js` 查看代理延迟

